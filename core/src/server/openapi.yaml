openapi: 3.0.0
info:
  title: PMXT Sidecar API
  description: >
    A unified local sidecar API for prediction markets (Polymarket, Kalshi, Limitless).
    This API acts as a JSON-RPC-style gateway. Each endpoint corresponds to a specific method
    on the generic exchange implementation.
  version: 0.4.4

servers:
  - url: http://localhost:3847
    description: Local development server

paths:
  /health:
    get:
      summary: Server Health Check
      operationId: healthCheck
      responses:
        '200':
          description: Server is consistent and running.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  timestamp:
                    type: integer
                    format: int64

  # ---------------------------------------------------------------------------
  # Market Data Endpoints
  # ---------------------------------------------------------------------------

  /api/{exchange}/fetchMarkets:
    post:
      summary: Fetch Markets
      operationId: fetchMarkets
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/MarketFilterParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
                verbose:
                  type: boolean
                  description: Enable verbose logging for this request
      responses:
        '200':
          description: List of unified markets
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UnifiedMarket'

  /api/{exchange}/fetchMarketsPaginated:
    post:
      summary: Fetch Markets (Paginated)
      operationId: fetchMarketsPaginated
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/MarketFilterParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
                verbose:
                  type: boolean
                  description: Enable verbose logging for this request
      responses:
        '200':
          description: Cursor-paginated list of unified markets
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PaginatedMarketResult'

  /api/{exchange}/fetchMarket:
    post:
      summary: Fetch Single Market
      operationId: fetchMarket
      description: >
        Fetch a single market by lookup parameters. Returns the first matching market
        or a 404 error if no market is found. Convenience wrapper around fetchMarkets.
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/MarketFilterParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: A single unified market
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UnifiedMarket'
        '404':
          description: Market not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/{exchange}/fetchOHLCV:
    post:
      summary: Fetch OHLCV Candles
      operationId: fetchOHLCV
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 2
                  maxItems: 2
                  description: "[id, params]"
                  example: ["0x123...", { "resolution": "1h" }]
                  items:
                    oneOf:
                      - type: string
                      - $ref: '#/components/schemas/OHLCVParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Historical prices
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/PriceCandle'

  /api/{exchange}/fetchOrderBook:
    post:
      summary: Fetch Order Book
      operationId: fetchOrderBook
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 1
                  items:
                    type: string
                    description: The outcome ID
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Current order book
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/OrderBook'

  /api/{exchange}/fetchTrades:
    post:
      summary: Fetch Trades
      operationId: fetchTrades
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 2
                  maxItems: 2
                  description: "[id, params]"
                  items:
                    oneOf:
                      - type: string
                      - $ref: '#/components/schemas/TradesParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Recent trades
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Trade'

  /api/{exchange}/fetchEvents:
    post:
      summary: Fetch Events
      operationId: fetchEvents
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/EventFetchParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: List of unified events
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UnifiedEvent'

  /api/{exchange}/fetchEvent:
    post:
      summary: Fetch Single Event
      operationId: fetchEvent
      description: >
        Fetch a single event by lookup parameters. Returns the first matching event
        or a 404 error if no event is found. Convenience wrapper around fetchEvents.
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/EventFetchParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: A single unified event
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UnifiedEvent'
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ---------------------------------------------------------------------------
  # WebSocket Streaming Endpoints
  # ---------------------------------------------------------------------------

  /api/{exchange}/watchOrderBook:
    post:
      summary: Watch Order Book (WebSocket Stream)
      operationId: watchOrderBook
      description: >
        Subscribe to real-time order book updates via WebSocket.
        Returns a promise that resolves with the next order book update.
        Call repeatedly in a loop to stream updates (CCXT Pro pattern).
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 2
                  description: "[outcomeId, limit?]"
                  items:
                    oneOf:
                      - type: string
                      - type: integer
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Next order book update
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/OrderBook'

  /api/{exchange}/watchTrades:
    post:
      summary: Watch Trades (WebSocket Stream)
      operationId: watchTrades
      description: >
        Subscribe to real-time trade updates via WebSocket.
        Returns a promise that resolves with the next trade(s).
        Call repeatedly in a loop to stream updates (CCXT Pro pattern).
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 3
                  description: "[outcomeId, since?, limit?]"
                  items:
                    oneOf:
                      - type: string
                      - type: integer
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Next trade update(s)
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Trade'

  /api/{exchange}/watchPrices:
    post:
      summary: Watch Prices (WebSocket Stream)
      operationId: watchPrices
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 1
                  items:
                    type: string
                    description: Market address
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Price update
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'

  /api/{exchange}/watchUserPositions:
    post:
      summary: Watch User Positions (WebSocket Stream)
      operationId: watchUserPositions
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: User position update
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'

  /api/{exchange}/watchUserTransactions:
    post:
      summary: Watch User Transactions (WebSocket Stream)
      operationId: watchUserTransactions
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: User transaction update
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'

  # ---------------------------------------------------------------------------
  # Trading Endpoints
  # ---------------------------------------------------------------------------

  /api/{exchange}/createOrder:
    post:
      summary: Create Order
      operationId: createOrder
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 1
                  items:
                    $ref: '#/components/schemas/CreateOrderParams'
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Order created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Order'

  /api/{exchange}/cancelOrder:
    post:
      summary: Cancel Order
      operationId: cancelOrder
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 1
                  items:
                    type: string
                    description: Order ID
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Order cancelled
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Order'

  /api/{exchange}/fetchOrder:
    post:
      summary: Fetch Order
      operationId: fetchOrder
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 1
                  maxItems: 1
                  items:
                    type: string
                    description: Order ID
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Order details
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Order'

  /api/{exchange}/fetchOpenOrders:
    post:
      summary: Fetch Open Orders
      operationId: fetchOpenOrders
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 1
                  items:
                    type: string
                    description: Optional Market ID
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: List of open orders
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Order'

  /api/{exchange}/fetchPositions:
    post:
      summary: Fetch Positions
      operationId: fetchPositions
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 0
                  items: {}
                  description: "Empty array (no arguments)"
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: User positions
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Position'

  /api/{exchange}/fetchBalance:
    post:
      summary: Fetch Balance
      operationId: fetchBalance
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                args:
                  type: array
                  maxItems: 0
                  items: {}
                  description: "Empty array (no arguments)"
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Account balances
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Balance'

  /api/{exchange}/getExecutionPrice:
    post:
      summary: Get Execution Price
      operationId: getExecutionPrice
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 3
                  maxItems: 3
                  description: "[orderBook, side, amount]"
                  items:
                    oneOf:
                      - $ref: '#/components/schemas/OrderBook'
                      - type: string
                        enum: [buy, sell]
                      - type: number
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Average execution price
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: number

  /api/{exchange}/getExecutionPriceDetailed:
    post:
      summary: Get Detailed Execution Price
      operationId: getExecutionPriceDetailed
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 3
                  maxItems: 3
                  description: "[orderBook, side, amount]"
                  items:
                    oneOf:
                      - $ref: '#/components/schemas/OrderBook'
                      - type: string
                        enum: [buy, sell]
                      - type: number
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Detailed execution result
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ExecutionPriceResult'

  # ---------------------------------------------------------------------------
  # Utility Methods
  # ---------------------------------------------------------------------------

  /api/{exchange}/filterMarkets:
    post:
      summary: Filter Markets
      operationId: filterMarkets
      description: >
        Filter a list of markets by criteria.
        Can filter by string query, structured criteria object, or custom filter function.
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 2
                  maxItems: 2
                  description: "[markets, criteria]"
                  items:
                    oneOf:
                      - type: array
                        items:
                          $ref: '#/components/schemas/UnifiedMarket'
                      - oneOf:
                          - type: string
                          - type: object
                          - type: string
                        description: "Filter criteria (string query, object, or function)"
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Filtered markets
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UnifiedMarket'

  /api/{exchange}/filterEvents:
    post:
      summary: Filter Events
      operationId: filterEvents
      description: >
        Filter a list of events by criteria.
        Can filter by string query, structured criteria object, or custom filter function.
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [args]
              properties:
                args:
                  type: array
                  minItems: 2
                  maxItems: 2
                  description: "[events, criteria]"
                  items:
                    oneOf:
                      - type: array
                        items:
                          $ref: '#/components/schemas/UnifiedEvent'
                      - oneOf:
                          - type: string
                          - type: object
                          - type: string
                        description: "Filter criteria (string query, object, or function)"
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: Filtered events
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UnifiedEvent'

  /api/{exchange}/close:
    post:
      summary: Close WebSocket Connections
      operationId: close
      description: >
        Close all WebSocket connections and cleanup resources.
        Call this when you're done streaming to properly release connections.
      parameters:
        - $ref: '#/components/parameters/ExchangeParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                credentials:
                  $ref: '#/components/schemas/ExchangeCredentials'
      responses:
        '200':
          description: WebSocket connections closed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'

components:
  parameters:
    ExchangeParam:
      in: path
      name: exchange
      schema:
        type: string
        enum: [polymarket, kalshi, limitless, probable, baozi, myriad]
      required: true
      description: The prediction market exchange to target.

  schemas:
    # -------------------------------------------------------------------------
    # API Response Wrappers
    # -------------------------------------------------------------------------
    BaseResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        error:
          $ref: '#/components/schemas/ErrorDetail'

    ErrorDetail:
      type: object
      properties:
        message:
          type: string

    BaseRequest:
      type: object
      description: Base request structure with optional credentials
      properties:
        credentials:
          $ref: '#/components/schemas/ExchangeCredentials'


    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          $ref: '#/components/schemas/ErrorDetail'

    # -------------------------------------------------------------------------
    # Core Data Models
    # -------------------------------------------------------------------------

    UnifiedMarket:
      type: object
      properties:
        marketId:
          type: string
          description: "The unique identifier for this market"
        title:
          type: string
        description:
          type: string
        outcomes:
          type: array
          items:
            $ref: '#/components/schemas/MarketOutcome'
        resolutionDate:
          type: string
          format: date-time
        volume24h:
          type: number
        volume:
          type: number
        liquidity:
          type: number
        openInterest:
          type: number
        url:
          type: string
        image:
          type: string
        category:
          type: string
        tags:
          type: array
          items:
            type: string
        "yes":
          $ref: '#/components/schemas/MarketOutcome'
        "no":
          $ref: '#/components/schemas/MarketOutcome'
        up:
          $ref: '#/components/schemas/MarketOutcome'
        down:
          $ref: '#/components/schemas/MarketOutcome'

    PaginatedMarketResult:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/UnifiedMarket'
        nextCursor:
          type: string
          description: Opaque cursor for fetching the next page
        total:
          type: integer
          description: Total number of markets in this snapshot

    MarketOutcome:
      type: object
      properties:
        outcomeId:
          type: string
          description: "Outcome ID for trading operations (CLOB Token ID for Polymarket, Market Ticker for Kalshi)"
        marketId:
          type: string
          description: "The market this outcome belongs to (set automatically)"
        label:
          type: string
        price:
          type: number
        priceChange24h:
          type: number
        metadata:
          type: object
          additionalProperties: true
          description: Exchange-specific metadata (e.g., clobTokenId for Polymarket)

    UnifiedEvent:
      type: object
      description: A grouped collection of related markets (e.g., "Who will be Fed Chair?" contains multiple candidate markets)
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        slug:
          type: string
        markets:
          type: array
          items:
            $ref: '#/components/schemas/UnifiedMarket'
        url:
          type: string
        image:
          type: string
        category:
          type: string
        tags:
          type: array
          items:
            type: string

    PriceCandle:
      type: object
      properties:
        timestamp:
          type: integer
        open:
          type: number
        high:
          type: number
        low:
          type: number
        close:
          type: number
        volume:
          type: number

    OrderBook:
      type: object
      properties:
        bids:
          type: array
          items:
            $ref: '#/components/schemas/OrderLevel'
        asks:
          type: array
          items:
            $ref: '#/components/schemas/OrderLevel'
        timestamp:
          type: integer

    OrderLevel:
      type: object
      properties:
        price:
          type: number
        size:
          type: number

    Trade:
      type: object
      properties:
        id:
          type: string
        price:
          type: number
        amount:
          type: number
        side:
          type: string
          enum: [buy, sell, unknown]
        timestamp:
          type: integer

    # -------------------------------------------------------------------------
    # Trading Data Models
    # -------------------------------------------------------------------------

    Order:
      type: object
      properties:
        id:
          type: string
        marketId:
          type: string
        outcomeId:
          type: string
        side:
          type: string
          enum: [buy, sell]
        type:
          type: string
          enum: [limit, market]
        price:
          type: number
        amount:
          type: number
        status:
          type: string
          enum: [pending, open, filled, cancelled, rejected]
        filled:
          type: number
        remaining:
          type: number
        timestamp:
          type: integer
        fee:
          type: number

    Position:
      type: object
      properties:
        marketId:
          type: string
        outcomeId:
          type: string
        outcomeLabel:
          type: string
        size:
          type: number
        entryPrice:
          type: number
        currentPrice:
          type: number
        unrealizedPnL:
          type: number
        realizedPnL:
          type: number

    Balance:
      type: object
      properties:
        currency:
          type: string
        total:
          type: number
        available:
          type: number
        locked:
          type: number

    ExecutionPriceResult:
      type: object
      properties:
        price:
          type: number
        filledAmount:
          type: number
        fullyFilled:
          type: boolean

    # -------------------------------------------------------------------------
    # Input Parameter Object Schemas
    # -------------------------------------------------------------------------

    MarketFilterParams:
      type: object
      properties:
        limit:
          type: integer
          default: 10000
        offset:
          type: integer
        cursor:
          type: string
          description: Opaque cursor returned by a previous fetchMarkets call
        sort:
          type: string
          enum: [volume, liquidity, newest]
        status:
          type: string
          enum: [active, closed, all]
          description: "Filter by market status (default: active)"
        searchIn:
          type: string
          enum: [title, description, both]
        query:
          type: string
        slug:
          type: string
        marketId:
          type: string
          description: "Direct lookup by market ID"
        outcomeId:
          type: string
          description: "Reverse lookup -- find market containing this outcome"
        eventId:
          type: string
          description: "Find markets belonging to an event"
        page:
          type: integer
        similarityThreshold:
          type: number

    EventFetchParams:
      type: object
      properties:
        query:
          type: string
        limit:
          type: integer
          default: 10000
        offset:
          type: integer
        status:
          type: string
          enum: [active, closed, all]
          description: "Filter by event status (default: active)"
        searchIn:
          type: string
          enum: [title, description, both]
        eventId:
          type: string
          description: "Direct lookup by event ID"
        slug:
          type: string
          description: "Lookup by event slug"

    HistoryFilterParams:
      type: object
      description: Deprecated - use OHLCVParams or TradesParams instead. Resolution is optional for backward compatibility.
      properties:
        resolution:
          type: string
          enum: [1m, 5m, 15m, 1h, 6h, 1d]
        start:
          type: string
          format: date-time
        end:
          type: string
          format: date-time
        limit:
          type: integer

    OHLCVParams:
      type: object
      required: [resolution]
      properties:
        resolution:
          type: string
          enum: [1m, 5m, 15m, 1h, 6h, 1d]
          description: Candle interval for aggregation
        start:
          type: string
          format: date-time
        end:
          type: string
          format: date-time
        limit:
          type: integer

    TradesParams:
      type: object
      description: Parameters for fetching trade history. No resolution parameter - trades are discrete events.
      properties:
        start:
          type: string
          format: date-time
        end:
          type: string
          format: date-time
        limit:
          type: integer

    CreateOrderParams:
      type: object
      required: [marketId, outcomeId, side, type, amount]
      properties:
        marketId:
          type: string
        outcomeId:
          type: string
        side:
          type: string
          enum: [buy, sell]
        type:
          type: string
          enum: [limit, market]
        amount:
          type: number
        price:
          type: number
        fee:
          type: number

    ExchangeCredentials:
      type: object
      description: Optional authentication credentials for exchange operations
      properties:
        apiKey:
          type: string
          description: API key for the exchange
        privateKey:
          type: string
          description: Private key for signing transactions
        apiSecret:
          type: string
          description: API secret (if required by exchange)
        passphrase:
          type: string
          description: Passphrase (if required by exchange)
        funderAddress:
          type: string
          description: The address funding the trades (Proxy address)
        signatureType:
          oneOf:
            - type: integer
            - type: string
          description: Signature type (0=EOA, 1=Poly Proxy, 2=Gnosis Safe, or names like 'gnosis_safe')

